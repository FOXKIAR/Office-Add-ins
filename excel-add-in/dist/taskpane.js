/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,o,n){e.exports=n.p+"8d768f65702f2137206f.css"},98362:function(e,o,n){e.exports=n.p+"assets/logo-filled.png"}},o={};function n(t){var r=o[t];if(void 0!==r)return r.exports;var c=o[t]={exports:{}};return e[t](c,c.exports,n),c.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var o=n.g.document;if(!e&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(e=o.currentScript.src),!e)){var t=o.getElementsByTagName("script");if(t.length)for(var r=t.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=t[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(e,t,r){return t=n(t),function(e,o){if(o&&("object"==c(o)||"function"==typeof o))return o;if(void 0!==o)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,o()?Reflect.construct(t,r||[],n(e).constructor):t.apply(e,r))}function o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(o=function(){return!!e})()}function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}function t(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),o&&r(e,o)}function r(e,o){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,o){return e.__proto__=o,e},r(e,o)}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function i(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function a(e,o){for(var n=0;n<o.length;n++){var t=o[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,u(t.key),t)}}function l(e,o,n){return o&&a(e.prototype,o),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function u(e){var o=function(e){if("object"!=c(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(o)?o:o+""}var f=function(){return l(function e(o){i(this,e),this.board=o,this.rotation=0},[{key:"move",value:function(e,o){var n=this.space.map(function(n){return{x:n.x+e,y:n.y+o}});return!!this.board.isValidPosition(n)&&(this.space=n,!0)}},{key:"down",value:function(){return this.move(0,1)}},{key:"left",value:function(){return this.move(-1,0)}},{key:"right",value:function(){return this.move(1,0)}},{key:"rotate",value:function(){var e=this.getPivot();if(!e||0===this.space.length)return!1;var o=this.space.map(function(o){var n=o.x-e.x,t=o.y-e.y;return{x:e.x-t,y:e.y+n}});return!!this.board.isValidPosition(o)&&(this.space=o,this.rotation=(this.rotation+1)%4,!0)}},{key:"getPivot",value:function(){return this.space&&this.space.length>1?this.space[1]:this.space&&this.space.length>0?this.space[0]:null}}])}(),s=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:4,y:0},{x:5,y:0},{x:6,y:0},{x:5,y:1}],t.color="yellow",t}return t(n,o),l(n)}(f),y=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:4,y:0},{x:4,y:1},{x:4,y:2},{x:5,y:2}],t.color="red",t}return t(n,o),l(n)}(f),p=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:5,y:0},{x:5,y:1},{x:4,y:2},{x:5,y:2}],t.color="blue",t}return t(n,o),l(n)}(f),h=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:4,y:0},{x:5,y:0},{x:5,y:1},{x:6,y:1}],t.color="green",t}return t(n,o),l(n)}(f),d=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:5,y:0},{x:6,y:0},{x:4,y:1},{x:5,y:1}],t.color="purple",t}return t(n,o),l(n)}(f),g=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:4,y:0},{x:5,y:0},{x:4,y:1},{x:5,y:1}],t.color="orange",t}return t(n,o),l(n,[{key:"rotate",value:function(){return!1}}])}(f),v=function(o){function n(o){var t;return i(this,n),(t=e(this,n,[o])).space=[{x:5,y:0},{x:5,y:1},{x:5,y:2},{x:5,y:3}],t.color="cyan",t}return t(n,o),l(n)}(f);function b(e){return new(0,[s,y,p,h,d,g,v][Math.floor(7*Math.random())])(e)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function w(e,o){for(var n=0;n<o.length;n++){var t=o[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,x(t.key),t)}}function x(e){var o=function(e){if("object"!=m(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(o)?o:o+""}var O,k,E,S,j=function(){return e=function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=o,this.height=n,this.grid=Array(n).fill().map(function(){return Array(o).fill(null)})},(o=[{key:"isValidPosition",value:function(e){var o=this;return e.every(function(e){return e.x>=0&&e.x<o.width&&e.y<o.height&&(e.y<0||!o.grid[e.y][e.x])})}},{key:"placeBlock",value:function(e){var o=this;e.space.forEach(function(n){n.y>=0&&(o.grid[n.y][n.x]=e.color)})}},{key:"clearLines",value:function(){for(var e=0,o=this.height-1;o>=0;o--)this.grid[o].every(function(e){return null!==e})&&(this.grid.splice(o,1),this.grid.unshift(Array(this.width).fill(null)),e++,o++);return e}}])&&w(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o}();function P(){var e,o,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function c(n,t,r,c){var l=t&&t.prototype instanceof a?t:a,u=Object.create(l.prototype);return T(u,"_invoke",function(n,t,r){var c,a,l,u=0,f=r||[],s=!1,y={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(o,n){return c=o,a=0,l=e,y.n=n,i}};function p(n,t){for(a=n,l=t,o=0;!s&&u&&!r&&o<f.length;o++){var r,c=f[o],p=y.p,h=c[2];n>3?(r=h===t)&&(l=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=e):c[0]<=p&&((r=n<2&&p<c[1])?(a=0,y.v=t,y.n=c[1]):p<h&&(r=n<3||c[0]>t||t>h)&&(c[4]=n,c[5]=t,y.n=h,a=0))}if(r||n>1)return i;throw s=!0,t}return function(r,f,h){if(u>1)throw TypeError("Generator is already running");for(s&&1===f&&p(f,h),a=f,l=h;(o=a<2?e:l)||!s;){c||(a?a<3?(a>1&&(y.n=-1),p(a,l)):y.n=l:y.v=l);try{if(u=2,c){if(a||(r="next"),o=c[r]){if(!(o=o.call(c,l)))throw TypeError("iterator result is not an object");if(!o.done)return o;l=o.value,a<2&&(a=0)}else 1===a&&(o=c.return)&&o.call(c),a<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),a=1);c=e}else if((o=(s=y.n<0)?l:n.call(t,y))!==i)break}catch(o){c=e,a=1,l=o}finally{u=1}}return{value:o,done:s}}}(n,r,c),!0),u}var i={};function a(){}function l(){}function u(){}o=Object.getPrototypeOf;var f=[][t]?o(o([][t]())):(T(o={},t,function(){return this}),o),s=u.prototype=a.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,T(e,r,"GeneratorFunction")),e.prototype=Object.create(s),e}return l.prototype=u,T(s,"constructor",u),T(u,"constructor",l),l.displayName="GeneratorFunction",T(u,r,"GeneratorFunction"),T(s),T(s,r,"Generator"),T(s,t,function(){return this}),T(s,"toString",function(){return"[object Generator]"}),(P=function(){return{w:c,m:y}})()}function T(e,o,n,t){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}T=function(e,o,n,t){function c(o,n){T(e,o,function(e){return this._invoke(o,n,e)})}o?r?r(e,o,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[o]=n:(c("next",0),c("throw",1),c("return",2))},T(e,o,n,t)}function I(e,o,n,t,r,c,i){try{var a=e[c](i),l=a.value}catch(e){return void n(e)}a.done?o(l):Promise.resolve(l).then(t,r)}function R(e){return function(){var o=this,n=arguments;return new Promise(function(t,r){var c=e.apply(o,n);function i(e){I(c,t,r,i,a,"next",e)}function a(e){I(c,t,r,i,a,"throw",e)}i(void 0)})}}var A,_,G,M,B=0,L=!1;function F(e,o){console.error("".concat(e," å¤±è´¥:"),o),o instanceof OfficeExtension.Error&&console.error("Office Extension é”™è¯¯:",o.debugInfo),U()}function C(){U(),Excel.run(function(){var e=R(P().m(function e(o){var n,t;return P().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0;try{n=o.workbook.worksheets.getItem("Sheet1")}catch(e){n=o.workbook.worksheets.add("Sheet1")}return(t=n.getRange("A1:L22")).format.fill.color="black",t.format.columnWidth=15,e.n=1,o.sync();case 1:return n.getRange("B2:K21").format.fill.color="white",e.n=2,o.sync();case 2:O=new j(10,20),D(),e.n=4;break;case 3:e.p=3,F("åˆå§‹åŒ–æ¸¸æˆ",e.v);case 4:return e.a(2)}},e,null,[[0,3]])}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){F("Excelæ“ä½œ",e)})}function D(){U(),L=!0,B=0,k=b(O),S=function(e){L&&("ArrowUp"===e.code?N("rotate"):"ArrowLeft"===e.code?N("left"):"ArrowRight"===e.code?N("right"):"ArrowDown"===e.code&&N("down"))},document.addEventListener("keydown",S),E&&clearInterval(E),E=setInterval(function(){if(L&&k){if(!k.down()){O.placeBlock(k);var e=O.clearLines();B+=100*e,k=b(O),O.isValidPosition(k.space)||(U(),console.log("æ¸¸æˆç»“æŸï¼å¾—åˆ†: ".concat(B)))}V()}else U()},500),V()}function U(){L=!1,E&&(clearInterval(E),E=null),S&&(document.removeEventListener("keydown",S),S=null)}function N(e){if(O&&k&&L){var o=!1;switch(e){case"rotate":o=k.rotate();break;case"left":o=k.left();break;case"right":o=k.right();break;case"down":o=k.down()}o&&V()}}function V(){O&&k&&L&&Excel.run(function(){var e=R(P().m(function e(o){var n,t,r,c,i;return P().w(function(e){for(;;)switch(e.p=e.n){case 0:for(e.p=0,n=o.workbook.worksheets.getItem("Sheet1"),(t=n.getRange("B2:K21")).format.fill.color="white",r=0;r<O.height;r++)for(c=0;c<O.width;c++)O.grid[r][c]&&(t.getCell(r,c).format.fill.color=O.grid[r][c]);return k.space.forEach(function(e){e.y>=0&&e.y<O.height&&e.x>=0&&e.x<O.width&&(t.getCell(e.y,e.x).format.fill.color=k.color)}),n.getRange("M2").values=[["å¾—åˆ†: ".concat(B)]],e.n=1,o.sync();case 1:e.n=3;break;case 2:e.p=2,i=e.v,console.error("æ¸²æŸ“æ¸¸æˆæ¿å¤±è´¥:",i),i instanceof OfficeExtension.Error&&console.error("Office Extension é”™è¯¯:",i.debugInfo),U();case 3:return e.a(2)}},e,null,[[0,2]])}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){console.error("Excelæ¸²æŸ“æ“ä½œå¤±è´¥:",e),U()})}function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function H(e,o){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,t)}return n}function K(e,o,n){return(o=function(e){var o=function(e){if("object"!=W(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,"string");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==W(o)?o:o+""}(o))in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e}function $(e,o){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,o){if(e){if("string"==typeof e)return Y(e,o);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,o):void 0}}(e))||o&&e&&"number"==typeof e.length){n&&(e=n);var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,c=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw c}}}}function Y(e,o){(null==o||o>e.length)&&(o=e.length);for(var n=0,t=Array(o);n<o;n++)t[n]=e[n];return t}function Z(){var e,o,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function c(n,t,r,c){var l=t&&t.prototype instanceof a?t:a,u=Object.create(l.prototype);return q(u,"_invoke",function(n,t,r){var c,a,l,u=0,f=r||[],s=!1,y={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(o,n){return c=o,a=0,l=e,y.n=n,i}};function p(n,t){for(a=n,l=t,o=0;!s&&u&&!r&&o<f.length;o++){var r,c=f[o],p=y.p,h=c[2];n>3?(r=h===t)&&(l=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=e):c[0]<=p&&((r=n<2&&p<c[1])?(a=0,y.v=t,y.n=c[1]):p<h&&(r=n<3||c[0]>t||t>h)&&(c[4]=n,c[5]=t,y.n=h,a=0))}if(r||n>1)return i;throw s=!0,t}return function(r,f,h){if(u>1)throw TypeError("Generator is already running");for(s&&1===f&&p(f,h),a=f,l=h;(o=a<2?e:l)||!s;){c||(a?a<3?(a>1&&(y.n=-1),p(a,l)):y.n=l:y.v=l);try{if(u=2,c){if(a||(r="next"),o=c[r]){if(!(o=o.call(c,l)))throw TypeError("iterator result is not an object");if(!o.done)return o;l=o.value,a<2&&(a=0)}else 1===a&&(o=c.return)&&o.call(c),a<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),a=1);c=e}else if((o=(s=y.n<0)?l:n.call(t,y))!==i)break}catch(o){c=e,a=1,l=o}finally{u=1}}return{value:o,done:s}}}(n,r,c),!0),u}var i={};function a(){}function l(){}function u(){}o=Object.getPrototypeOf;var f=[][t]?o(o([][t]())):(q(o={},t,function(){return this}),o),s=u.prototype=a.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,q(e,r,"GeneratorFunction")),e.prototype=Object.create(s),e}return l.prototype=u,q(s,"constructor",u),q(u,"constructor",l),l.displayName="GeneratorFunction",q(u,r,"GeneratorFunction"),q(s),q(s,r,"Generator"),q(s,t,function(){return this}),q(s,"toString",function(){return"[object Generator]"}),(Z=function(){return{w:c,m:y}})()}function q(e,o,n,t){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}q=function(e,o,n,t){function c(o,n){q(e,o,function(e){return this._invoke(o,n,e)})}o?r?r(e,o,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[o]=n:(c("next",0),c("throw",1),c("return",2))},q(e,o,n,t)}function z(e,o,n,t,r,c,i){try{var a=e[c](i),l=a.value}catch(e){return void n(e)}a.done?o(l):Promise.resolve(l).then(t,r)}function J(e){return function(){var o=this,n=arguments;return new Promise(function(t,r){var c=e.apply(o,n);function i(e){z(c,t,r,i,a,"next",e)}function a(e){z(c,t,r,i,a,"throw",e)}i(void 0)})}}var Q=0,X=!1;function ee(e,o){console.error("".concat(e," å¤±è´¥:"),o),o instanceof OfficeExtension.Error&&console.error("Office Extension é”™è¯¯:",o.debugInfo),X=!1}function oe(){console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šå¼€å§‹åˆå§‹åŒ–"),Excel.run(function(){var e=J(Z().m(function e(o){var n,t,r,c;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šExcel.run() æˆåŠŸå¯åŠ¨"),e.p=1,console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šå°è¯•èŽ·å–å·¥ä½œè¡¨ Sheet1"),(n=o.workbook.worksheets.getItem("Sheet1")).load("name"),e.n=2,o.sync();case 2:console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæˆåŠŸèŽ·å–å·¥ä½œè¡¨:",n.name),e.n=5;break;case 3:return e.p=3,e.v,console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šå·¥ä½œè¡¨ Sheet1 ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°å·¥ä½œè¡¨"),n=o.workbook.worksheets.add("Sheet1"),e.n=4,o.sync();case 4:console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šåˆ›å»ºå·¥ä½œè¡¨æˆåŠŸ");case 5:return console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šå¼€å§‹è®¾ç½®æ¸¸æˆåŒºåŸŸ"),(t=n.getRange("A1:AZ25")).format.fill.color="black",t.format.columnWidth=15,e.n=6,o.sync();case 6:return console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸¸æˆè¾¹æ¡†è®¾ç½®å®Œæˆ"),(r=n.getRange("B2:AY24")).format.fill.color="white",r.values="",e.n=7,o.sync();case 7:console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸¸æˆåŒºåŸŸåˆå§‹åŒ–å®Œæˆ"),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šè°ƒç”¨ startGame()"),ne(),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šåˆå§‹åŒ–å®Œæˆï¼"),e.n=9;break;case 8:e.p=8,c=e.v,console.error("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šåˆå§‹åŒ–å¤±è´¥",c),ee("åˆå§‹åŒ–è´ªåƒè›‡æ¸¸æˆ",c);case 9:return e.a(2)}},e,null,[[1,3],[0,8]])}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){console.error("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šExcel.run() å¤±è´¥",e),ee("Excelæ“ä½œ",e)})}function ne(){console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šstartGame() è¢«è°ƒç”¨"),_=[{x:10,y:12},{x:11,y:12},{x:12,y:12}],console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šè›‡åˆå§‹åŒ–å®Œæˆ",_),M="LEFT",Q=0,X=!0,console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸¸æˆçŠ¶æ€åˆå§‹åŒ–å®Œæˆ"),te(),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šç¬¬ä¸€ä¸ªé£Ÿç‰©ç”Ÿæˆå®Œæˆ",G),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬å™¨"),document.addEventListener("keydown",re),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šé”®ç›˜äº‹ä»¶ç›‘å¬å™¨æ·»åŠ å®Œæˆ"),A&&(console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸…é™¤ä¹‹å‰çš„æ¸¸æˆå¾ªçŽ¯"),clearInterval(A)),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šå¼€å§‹æ¸¸æˆå¾ªçŽ¯"),A=setInterval(function(){X?(console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸¸æˆå¾ªçŽ¯è¿è¡Œä¸­..."),function(){var e=function(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?H(Object(n),!0).forEach(function(o){K(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}({},_[0]);switch(M){case"UP":e.y-=1;break;case"DOWN":e.y+=1;break;case"LEFT":e.x-=1;break;case"RIGHT":e.x+=1}if(function(e){if(e.x<0||e.x>49||e.y<0||e.y>22)return!0;for(var o=0;o<_.length;o++)if(0!==o&&e.x===_[o].x&&e.y===_[o].y)return!0;return!1}(e))return X=!1,clearInterval(A),document.removeEventListener("keydown",re),void Excel.run(function(){var e=J(Z().m(function e(o){var n,t,r,c,i,a,l,u;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:for(e.p=0,n=o.workbook.worksheets.getItem("Sheet1"),t="GAME OVER!",(r=n.getRange("B12:K13")).format.fill.color="black",r.format.font.color="red",r.format.font.bold=!0,r.values="",c=0;c<10;c++)r.getCell(0,c).values=t[c];for(i="å¾—åˆ†: ".concat(Q),(a=n.getRange("B14:K14")).format.fill.color="black",a.format.font.color="white",l=0;l<i.length;l++)a.getCell(0,l).values=i[l];return e.n=1,o.sync();case 1:e.n=3;break;case 2:e.p=2,u=e.v,console.error("è´ªåƒè›‡æ¸¸æˆç»“æŸæ˜¾ç¤ºå¤±è´¥:",u),u instanceof OfficeExtension.Error&&console.error("Office Extension é”™è¯¯:",u.debugInfo);case 3:return e.a(2)}},e,null,[[0,2]])}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){console.error("Excelæ“ä½œå¤±è´¥:",e)});_.unshift(e),e.x===G.x&&e.y===G.y?(Q+=10,te()):_.pop()}(),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šrenderSnake() è¢«è°ƒç”¨"),_&&G?(console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šå¼€å§‹æ¸²æŸ“ï¼Œè›‡é•¿åº¦:",_.length,"é£Ÿç‰©ä½ç½®:",G),Excel.run(function(){var e=J(Z().m(function e(o){var n,t,r;return Z().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šèŽ·å–å·¥ä½œè¡¨å’ŒèŒƒå›´"),n=o.workbook.worksheets.getItem("Sheet1"),t=n.getRange("B2:AY24"),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸…é™¤æ¸¸æˆåŒºåŸŸ"),t.format.fill.color="white",console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šç»˜åˆ¶è›‡"),_.forEach(function(e,o){e.y>=0&&e.y<23&&e.x>=0&&e.x<50&&(t.getCell(e.y,e.x).format.fill.color=0===o?"green":"lightgreen")}),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šç»˜åˆ¶é£Ÿç‰©"),G.y>=0&&G.y<23&&G.x>=0&&G.x<50&&(t.getCell(G.y,G.x).format.fill.color="red"),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ›´æ–°åˆ†æ•°æ˜¾ç¤º"),n.getRange("AZ2").values="å¾—åˆ†: ".concat(Q),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šåŒæ­¥åˆ°Excel"),e.n=1,o.sync();case 1:console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸²æŸ“å®Œæˆï¼"),e.n=3;break;case 2:e.p=2,r=e.v,console.error("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸²æŸ“å¤±è´¥",r),r instanceof OfficeExtension.Error&&console.error("ðŸ Office Extension é”™è¯¯:",r.debugInfo),X=!1;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){console.error("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šExcelæ¸²æŸ“æ“ä½œå¤±è´¥",e),X=!1})):console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šè›‡æˆ–é£Ÿç‰©ä¸å­˜åœ¨ï¼Œè·³è¿‡æ¸²æŸ“")):console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸¸æˆå·²æš‚åœï¼Œè·³è¿‡å¾ªçŽ¯")},200),console.log("ðŸ è´ªåƒè›‡æ¸¸æˆï¼šæ¸¸æˆå¾ªçŽ¯å·²å¯åŠ¨ï¼Œé—´éš”200ms")}function te(){var e,o;do{o=!1,e={x:Math.floor(49*Math.random()),y:Math.floor(22*Math.random())};var n,t=$(_);try{for(t.s();!(n=t.n()).done;){var r=n.value;if(r.x===e.x&&r.y===e.y){o=!0;break}}}catch(e){t.e(e)}finally{t.f()}}while(o);G=e}function re(e){if(X)switch(e.code){case"ArrowUp":"DOWN"!==M&&(M="UP");break;case"ArrowDown":"UP"!==M&&(M="DOWN");break;case"ArrowLeft":"RIGHT"!==M&&(M="LEFT");break;case"ArrowRight":"LEFT"!==M&&(M="RIGHT");break;case"Space":X=!X}}function ce(){var e,o,n="function"==typeof Symbol?Symbol:{},t=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function c(n,t,r,c){var l=t&&t.prototype instanceof a?t:a,u=Object.create(l.prototype);return ie(u,"_invoke",function(n,t,r){var c,a,l,u=0,f=r||[],s=!1,y={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(o,n){return c=o,a=0,l=e,y.n=n,i}};function p(n,t){for(a=n,l=t,o=0;!s&&u&&!r&&o<f.length;o++){var r,c=f[o],p=y.p,h=c[2];n>3?(r=h===t)&&(l=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=e):c[0]<=p&&((r=n<2&&p<c[1])?(a=0,y.v=t,y.n=c[1]):p<h&&(r=n<3||c[0]>t||t>h)&&(c[4]=n,c[5]=t,y.n=h,a=0))}if(r||n>1)return i;throw s=!0,t}return function(r,f,h){if(u>1)throw TypeError("Generator is already running");for(s&&1===f&&p(f,h),a=f,l=h;(o=a<2?e:l)||!s;){c||(a?a<3?(a>1&&(y.n=-1),p(a,l)):y.n=l:y.v=l);try{if(u=2,c){if(a||(r="next"),o=c[r]){if(!(o=o.call(c,l)))throw TypeError("iterator result is not an object");if(!o.done)return o;l=o.value,a<2&&(a=0)}else 1===a&&(o=c.return)&&o.call(c),a<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),a=1);c=e}else if((o=(s=y.n<0)?l:n.call(t,y))!==i)break}catch(o){c=e,a=1,l=o}finally{u=1}}return{value:o,done:s}}}(n,r,c),!0),u}var i={};function a(){}function l(){}function u(){}o=Object.getPrototypeOf;var f=[][t]?o(o([][t]())):(ie(o={},t,function(){return this}),o),s=u.prototype=a.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,ie(e,r,"GeneratorFunction")),e.prototype=Object.create(s),e}return l.prototype=u,ie(s,"constructor",u),ie(u,"constructor",l),l.displayName="GeneratorFunction",ie(u,r,"GeneratorFunction"),ie(s),ie(s,r,"Generator"),ie(s,t,function(){return this}),ie(s,"toString",function(){return"[object Generator]"}),(ce=function(){return{w:c,m:y}})()}function ie(e,o,n,t){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ie=function(e,o,n,t){function c(o,n){ie(e,o,function(e){return this._invoke(o,n,e)})}o?r?r(e,o,{value:n,enumerable:!t,configurable:!t,writable:!t}):e[o]=n:(c("next",0),c("throw",1),c("return",2))},ie(e,o,n,t)}function ae(e,o,n,t,r,c,i){try{var a=e[c](i),l=a.value}catch(e){return void n(e)}a.done?o(l):Promise.resolve(l).then(t,r)}function le(e){return function(){var o=this,n=arguments;return new Promise(function(t,r){var c=e.apply(o,n);function i(e){ae(c,t,r,i,a,"next",e)}function a(e){ae(c,t,r,i,a,"throw",e)}i(void 0)})}}function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function fe(){return se.apply(this,arguments)}function se(){return se=le(ce().m(function e(){var o;return ce().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=le(ce().m(function e(o){var n;return ce().w(function(e){for(;;)switch(e.n){case 0:return(n=o.workbook.getSelectedRange()).load("address"),n.format.fill.color="yellow",e.n=1,o.sync();case 1:console.log("The range address was ".concat(n.address,"."));case 2:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,o=e.v,console.error(o);case 3:return e.a(2)}},e,null,[[0,2]])})),se.apply(this,arguments)}function ye(){return pe.apply(this,arguments)}function pe(){return pe=le(ce().m(function e(){var o;return ce().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=le(ce().m(function e(o){var n,t,r,c,i;return ce().w(function(e){for(;;)switch(e.n){case 0:return i=function(e){return e.toString(16).padStart(2,"0")},(n=o.workbook.getSelectedRange()).load("address"),t=Math.floor(256*Math.random()),r=Math.floor(256*Math.random()),c=Math.floor(256*Math.random()),n.format.fill.color="#".concat(i(r)).concat(i(c)).concat(i(t)),t=Math.floor(256*Math.random()),r=Math.floor(256*Math.random()),c=Math.floor(256*Math.random()),n.format.font.color="#".concat(i(r)).concat(i(c)).concat(i(t)),e.n=1,o.sync();case 1:console.log("The range address was ".concat(n.address,"."));case 2:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,o=e.v,console.error(o);case 3:return e.a(2)}},e,null,[[0,2]])})),pe.apply(this,arguments)}function he(){console.log("ðŸŽ¯ ä¿„ç½—æ–¯æ–¹å—æŒ‰é’®è¢«ç‚¹å‡»ï¼");try{C(),console.log("âœ… ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆå¯åŠ¨æˆåŠŸ")}catch(e){console.error("âŒ ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆå¯åŠ¨å¤±è´¥:",e)}}function de(){console.log("ðŸŽ¯ è´ªåƒè›‡æŒ‰é’®è¢«ç‚¹å‡»ï¼");try{oe(),console.log("âœ… è´ªåƒè›‡æ¸¸æˆå¯åŠ¨æˆåŠŸ")}catch(e){console.error("âŒ è´ªåƒè›‡æ¸¸æˆå¯åŠ¨å¤±è´¥:",e)}}function ge(){console.log("ðŸ› è°ƒè¯•æŒ‰é’®è¢«ç‚¹å‡»ï¼"),console.log("ðŸ› æµ‹è¯•1: Officeå¯¹è±¡çŠ¶æ€","undefined"==typeof Office?"undefined":ue(Office)),console.log("ðŸ› æµ‹è¯•1: Excelå¯¹è±¡çŠ¶æ€","undefined"==typeof Excel?"undefined":ue(Excel)),console.log("ðŸ› æµ‹è¯•1: OfficeExtensionå¯¹è±¡çŠ¶æ€","undefined"==typeof OfficeExtension?"undefined":ue(OfficeExtension)),console.log("ðŸ› æµ‹è¯•2: å½“å‰æ–‡æ¡£å…ƒç´ æ•°é‡",document.querySelectorAll("*").length),console.log("ðŸ› æµ‹è¯•2: snakeæŒ‰é’®å…ƒç´ ",document.getElementById("snake")),console.log("ðŸ› æµ‹è¯•2: Office.jsæ˜¯å¦å·²åŠ è½½å®Œæˆ",void 0!==Office.context);try{Excel.run(function(){var e=le(ce().m(function e(o){var n,t;return ce().w(function(e){for(;;)switch(e.n){case 0:return console.log("ðŸ› æµ‹è¯•3: Excel.run() æˆåŠŸå¯åŠ¨"),n=o.workbook.worksheets.getItem("Sheet1"),(t=n.getRange("A1")).values=[["è°ƒè¯•æµ‹è¯•æˆåŠŸï¼"]],t.format.fill.color="yellow",e.n=1,o.sync();case 1:console.log("ðŸ› æµ‹è¯•3: Excelæ“ä½œæˆåŠŸå®Œæˆï¼");case 2:return e.a(2)}},e)}));return function(o){return e.apply(this,arguments)}}()).catch(function(e){console.error("ðŸ› æµ‹è¯•3: Excelæ“ä½œå¤±è´¥:",e),console.error("ðŸ› æµ‹è¯•3: é”™è¯¯è¯¦æƒ…:",{name:e.name,message:e.message,code:e.code,stack:e.stack}),e instanceof OfficeExtension.Error&&console.error("ðŸ› æµ‹è¯•3: OfficeExtensioné”™è¯¯è¯¦æƒ…:",e.debugInfo)})}catch(e){console.error("ðŸ› æµ‹è¯•3: Excel.run() å¤±è´¥:",e),console.error("ðŸ› æµ‹è¯•3: é”™è¯¯ç±»åž‹:",e.constructor.name)}try{console.log("ðŸ› æµ‹è¯•4: æ£€æŸ¥æ¸¸æˆæ¨¡å—å¯¼å…¥çŠ¶æ€"),console.log("ðŸ› æµ‹è¯•4: playTetriså‡½æ•°:",ue(C)),console.log("ðŸ› æµ‹è¯•4: playSnakeå‡½æ•°:",ue(oe))}catch(e){console.error("ðŸ› æµ‹è¯•4: æ¨¡å—æ£€æŸ¥å¤±è´¥:",e)}alert("è°ƒè¯•æµ‹è¯•å®Œæˆï¼è¯·æŸ¥çœ‹æŽ§åˆ¶å°æ—¥å¿—ã€‚\nå¦‚æžœçœ‹åˆ°é”™è¯¯ï¼Œè¯·å¤åˆ¶é”™è¯¯ä¿¡æ¯ç»™æˆ‘ã€‚")}window.addEventListener("error",function(e){var o;console.error("ðŸš¨ å…¨å±€é”™è¯¯æ•èŽ·:",e.error),console.error("ðŸš¨ é”™è¯¯ä¿¡æ¯:",e.message),console.error("ðŸš¨ é”™è¯¯æ–‡ä»¶:",e.filename),console.error("ðŸš¨ é”™è¯¯è¡Œå·:",e.lineno),console.error("ðŸš¨ é”™è¯¯åˆ—å·:",e.colno),console.error("ðŸš¨ é”™è¯¯å †æ ˆ:",null===(o=e.error)||void 0===o?void 0:o.stack),alert("è„šæœ¬é”™è¯¯: ".concat(e.message,"\nè¯·æŸ¥çœ‹æŽ§åˆ¶å°èŽ·å–è¯¦ç»†ä¿¡æ¯ã€‚"))}),window.addEventListener("unhandledrejection",function(e){console.error("ðŸš¨ æœªå¤„ç†çš„Promiseæ‹’ç»:",e.reason),console.error("ðŸš¨ Promiseæ‹’ç»è¯¦æƒ…:",e),alert("Promiseé”™è¯¯: ".concat(e.reason,"\nè¯·æŸ¥çœ‹æŽ§åˆ¶å°èŽ·å–è¯¦ç»†ä¿¡æ¯ã€‚"))}),"undefined"!=typeof Office?Office.onReady(function(e){console.log("ðŸŽ¯ Office.onReady() è¢«è°ƒç”¨",e)}).catch(function(e){console.error("ðŸš¨ Office.onReady() å¤±è´¥:",e),alert("OfficeåŠ è½½å¤±è´¥ï¼Œè¯·ç¡®ä¿åœ¨ExcelçŽ¯å¢ƒä¸­è¿è¡Œã€‚")}):(console.error("ðŸš¨ Office.js æœªåŠ è½½"),alert("Office.js åº“æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥ã€‚")),Office.onReady(function(e){if(console.log("ðŸŽ¯ Office.onReady() è¢«è°ƒç”¨",e),e.host===Office.HostType.Excel){console.log("âœ… ç¡®è®¤è¿è¡Œåœ¨ExcelçŽ¯å¢ƒä¸­");try{var o,n,t;console.log("ðŸŽ¯ æ£€æŸ¥æ¨¡å—å¯¼å…¥çŠ¶æ€:"),console.log("- playTetris:",ue(C)),console.log("- playSnake:",ue(oe)),document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",console.log("ðŸŽ¯ ç»‘å®šæŒ‰é’®äº‹ä»¶...");var r=document.getElementById("run"),c=document.getElementById("rand"),i=document.getElementById("tetris"),a=document.getElementById("snake");console.log("ðŸŽ¯ æŒ‰é’®å…ƒç´ èŽ·å–ç»“æžœ:"),console.log("- runæŒ‰é’®:",r),console.log("- randæŒ‰é’®:",c),console.log("- tetrisæŒ‰é’®:",i),console.log("- snakeæŒ‰é’®:",a),r?(r.onclick=fe,console.log("âœ… runæŒ‰é’®äº‹ä»¶ç»‘å®šæˆåŠŸ")):console.error("âŒ runæŒ‰é’®å…ƒç´ æœªæ‰¾åˆ°"),c?(c.onclick=ye,console.log("âœ… randæŒ‰é’®äº‹ä»¶ç»‘å®šæˆåŠŸ")):console.error("âŒ randæŒ‰é’®å…ƒç´ æœªæ‰¾åˆ°"),i?(i.onclick=he,console.log("âœ… tetrisæŒ‰é’®äº‹ä»¶ç»‘å®šæˆåŠŸ")):console.error("âŒ tetrisæŒ‰é’®å…ƒç´ æœªæ‰¾åˆ°"),a?(a.onclick=de,console.log("âœ… snakeæŒ‰é’®äº‹ä»¶ç»‘å®šæˆåŠŸ")):console.error("âŒ snakeæŒ‰é’®å…ƒç´ æœªæ‰¾åˆ°");var l=document.getElementById("debug");l?(l.onclick=ge,console.log("âœ… debugæŒ‰é’®äº‹ä»¶ç»‘å®šæˆåŠŸ")):console.error("âŒ debugæŒ‰é’®å…ƒç´ æœªæ‰¾åˆ°"),console.log("ðŸŽ¯ æ‰€æœ‰æŒ‰é’®äº‹ä»¶ç»‘å®šå®Œæˆï¼"),console.log("ðŸŽ¯ Office.js ç‰ˆæœ¬:",(null===(o=Office.context.diagnostics)||void 0===o?void 0:o.version)||"æœªçŸ¥"),console.log("ðŸŽ¯ Office ä¸»æœº:",(null===(n=Office.context.diagnostics)||void 0===n?void 0:n.host)||"æœªçŸ¥"),console.log("ðŸŽ¯ Office å¹³å°:",(null===(t=Office.context.diagnostics)||void 0===t?void 0:t.platform)||"æœªçŸ¥")}catch(e){console.error("ðŸŽ¯ æŒ‰é’®äº‹ä»¶ç»‘å®šå¤±è´¥:",e)}}else console.warn("âš ï¸ ä¸åœ¨ExcelçŽ¯å¢ƒä¸­ï¼Œå½“å‰çŽ¯å¢ƒ:",e.host)})}(),new URL(n(58394),n.b),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map